<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title data-i18n="settings_title">代理助手设置</title>
  <!-- Try using a simpler favicon path -->
  <link rel="icon" type="image/png" href="./images/icon-128.png">
  <link rel="shortcut icon" type="image/png" href="./images/icon-128.png">
  <link href="./css/eye-button.css" rel="stylesheet">
  <link href="./css/main.css" rel="stylesheet">
  <link href="./css/theme.css" rel="stylesheet">
</head>

<body>
  <div class="box">
    <div class="logo">
      <img src="./images/icon-128.png" alt="logo" />
      <span class="logo-text" data-i18n="app_name">代理助手</span>
    </div>

    <div class="t1" data-i18n="manage_proxies">管理代理</div>
    <div class="header-container">
      <div class="t2" data-i18n="manage_proxies_desc">添加、编辑或删除您的代理</div>
      <div class="list-controls">
          <button id="add-proxy-btn" class="control-btn">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
              <span data-i18n="add_new">新增</span>
          </button>
          <button id="test-all-btn" class="control-btn">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"/></svg>
              <span data-i18n="test_all">测试</span>
          </button>
          <button id="expand-collapse-btn" class="control-btn">
              <svg class="icon-expand" viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
              <span data-i18n="expand_all">展开</span>
          </button>
      </div>
    </div>

    <div class="list" id="proxy-list">

    </div>

    <div class="t1" style="margin-top: 40px;" data-i18n="system_config">系统配置</div>
    <div class="t2" style="margin-bottom: 25px;" data-i18n="config_desc">导出当前的代理列表及系统设置以便备份或与他人共享。</div>

    <div class="system-config-list">
      <!-- Language Setting -->
      <div class="config-row">
          <div class="config-row-left">
              <div class="config-row-title" data-i18n="language_settings">语言设置</div>
              <div class="config-row-desc" data-i18n="select_language">选择语言</div>
          </div>
          <div class="config-row-right">
              <div class="lh-select language-selector" style="width: 150px;">
                  <div class="lh-select_k">
                      <span class="lh-select-val" id="current-language-display">简体中文</span>
                      <span class="iconfont"></span>
                  </div>
                  <ul class="lh-select-op" id="language-options">
                      <li data-value="zh-CN">简体中文</li>
                      <li data-value="zh-TW">繁體中文</li>
                      <li data-value="en">English</li>
                      <li data-value="ja">日本語</li>
                      <li data-value="fr">Français</li>
                      <li data-value="de">Deutsch</li>
                      <li data-value="es">Español</li>
                      <li data-value="ko">한국어</li>
                      <li data-value="pt">Português</li>
                      <li data-value="ru">Русский</li>
                  </ul>
              </div>
          </div>
      </div>

      <!-- Theme Setting -->
      <div class="config-row">
          <div class="config-row-left">
              <div class="config-row-title" data-i18n="theme_settings">主题模式</div>
              <div class="config-row-desc" data-i18n="theme_settings_desc">选择白天模式、夜间模式或自动切换</div>
          </div>
          <div class="config-row-right">
              <div class="theme-selector">
                  <button class="theme-btn" data-theme="light" data-i18n="theme_light">白天</button>
                  <button class="theme-btn" data-theme="dark" data-i18n="theme_dark">夜间</button>
                  <button class="theme-btn" data-theme="auto" data-i18n="theme_auto">自动</button>
              </div>
          </div>
      </div>

      <!-- Auto Mode Time Settings -->
      <div class="config-row auto-mode-time-row" style="display: none;">
          <div class="config-row-left">
              <div class="config-row-title" data-i18n="dark_mode_schedule">自动切换时间</div>
              <div class="config-row-desc" data-i18n="dark_mode_schedule_desc">设置夜间模式的起止时间</div>
          </div>
          <div class="config-row-right">
              <div class="time-input-group">
                  <label data-i18n="start_time">开始时间</label>
                  <input type="time" id="night-mode-start" value="22:00">
                  <label data-i18n="end_time">结束时间</label>
                  <input type="time" id="night-mode-end" value="06:00">
              </div>
          </div>
      </div>

      <!-- Sync Setting -->
      <div class="config-row">
          <div class="config-row-left">
              <div class="config-row-title" data-i18n="cloud_sync_settings">云同步方式</div>
              <div class="config-row-desc">
                  <span data-i18n="cloud_sync_desc">选择您的云同步方式，当前云同步方式: </span>
                  <span id="sync-status-badge" class="sync-status-badge"></span>
              </div>
          </div>
          <div class="config-row-right">
              <button id="open-sync-config-btn" class="control-btn" style="margin-right: 10px;">
                  <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M19.36 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.64-4.96zM19 18H6c-2.21 0-4-1.79-4-4 0-2.05 1.53-3.76 3.56-3.97l1.07-.11.5-.95C8.08 7.14 9.94 6 12 6c2.62 0 4.88 1.86 5.39 4.43l.3 1.5 1.53.11c1.56.1 2.78 1.41 2.78 2.96 0 1.65-1.35 3-3 3z"/></svg>
                  <span data-i18n="config_sync_btn">配置</span>
              </button>  
              <button id="sync-pull-btn" class="control-btn" style="margin-right: 10px;">
                  <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/></svg>
                  <span data-i18n="sync_pull">拉取</span>
              </button>
              <button id="sync-push-btn" class="control-btn">
                  <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM8 15h10v2H8v-2zm3-7.5L7.5 11 11 14.5l3.5-3.5L11 7.5z"/></svg>
                  <span data-i18n="sync_push">推送</span>
              </button>
          </div>
      </div>

      <!-- Config Management -->
      <div class="config-row">
          <div class="config-row-left">
              <div class="config-row-title" data-i18n="config_management">配置管理</div>
              <div class="config-row-desc" data-i18n="config_desc">管理系统配置</div>
          </div>
          <div class="config-row-right">
              <div class="config-actions">
                  <div class="export_btn">
                      <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                      <span data-i18n="export_config">导出</span>
                  </div>
                  <div class="import_json_btn">
                      <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"/></svg>
                      <span data-i18n="import_config">导入</span>
                  </div>
                  <input type="file" id="json_file_input" accept=".json" style="display: none;" />
              </div>
          </div>
      </div>

      <!-- Proxy Detection -->
      <div class="config-row">
          <div class="config-row-left">
              <div class="config-row-title" data-i18n="proxy_detection">代理状态检测</div>
              <div class="config-row-desc" data-i18n="proxy_detection_desc">检测当前系统代理配置，判断是否使用本插件</div>
          </div>
          <div class="config-row-right">
              <button id="detect-proxy-btn" class="control-btn">
                  <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                  <span data-i18n="proxy_detection_button">检测</span>
              </button>
              <button id="pac-details-btn" class="control-btn" style="margin-left: 10px;">
                  <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
                  <span data-i18n="view_pac_button">查看PAC</span>
              </button>
          </div>
      </div>
    </div>

  </div>

  <div class="del_tip">
    <div class="del_tip_box">
      <div class="del_tip_title" data-i18n="delete_proxy_title">删除代理</div>
      <div class="del_tip_content" data-i18n="delete_proxy_confirm">确定要删除这个代理吗？</div>
      <div class="del_tip_btn">
          <div class="del_tip_Cancel_btn" data-i18n="cancel">取消</div>
          <div class="del_tip_del_btn" data-i18n="delete">删除</div>
      </div>
      <div class="del_tip_close_btn"></div>
    </div>
  </div>

  <div class="su_tip" data-i18n="save_success">保存成功</div>

  <!-- Proxy Detection Result Popup -->
  <div class="proxy_detection_tip">
      <div class="proxy_detection_box">
          <div class="proxy_detection_header">
              <span data-i18n="proxy_detection_title">代理状态检测结果</span>
              <div class="proxy_detection_close_btn"></div>
          </div>
          <div class="proxy_detection_content">
              <!-- Detection Status Icon -->
              <div class="detection-status-icon" id="detection-status-icon"></div>
              <!-- Detection Status Text -->
              <div class="detection-status-text" id="detection-status-text"></div>
              <!-- Detailed Information -->
              <div class="detection-details" id="detection-details">
                  <!-- Dynamically inserted detailed information -->
              </div>
              <!-- Warning Message -->
              <div class="detection-warning" id="detection-warning" style="display: none;"></div>
              <!-- Suggestion -->
              <div class="detection-suggestion" id="detection-suggestion" style="display: none;">
                  <span data-i18n="proxy_suggestion">💡 建议</span>
                  <span id="detection-suggestion-text"></span>
              </div>
          </div>
          <div class="proxy_detection_btn">
              <div class="proxy_detection_close_btn2" data-i18n="close">关闭</div>
          </div>
      </div>
  </div>

  <!-- Sync Config Popup -->
  <div class="sync_config_tip">
      <div class="sync_config_box">
          <div class="sync_config_header">
              <span data-i18n="cloud_sync_settings">云同步设置</span>
              <div class="sync_config_close_btn"></div>
          </div>
          <div class="sync_config_content">
              
              <div class="form-item" style="margin-bottom: 20px;">
                  <label data-i18n="sync_method">同步方式</label>
                  <div class="lh-select sync-selector" data-type="sync_mode" style="width: 100%;">
                      <div class="lh-select_k">
                          <span class="lh-select-val" id="current-sync-display" data-i18n="sync_native">浏览器原生同步</span>
                          <span class="iconfont"></span>
                      </div>
                      <ul class="lh-select-op" id="sync-options">
                          <li data-value="native" data-i18n="sync_native">浏览器原生同步</li>
                          <li data-value="gist" data-i18n="sync_gist">GitHub Gist</li>
                      </ul>
                  </div>
              </div>

              <!-- Gist Config Panel -->
              <div class="sync-panel" id="gist-config" style="display: none;">
                  <div class="gist-instruction">
                      <div style="margin-bottom: 8px; display: flex; justify-content: space-between; flex-wrap: wrap; gap: 5px;">
                          <span data-i18n="gist_instruction" style="margin-right: auto; padding-right: 10px;">建议使用 Tokens (classic)，仅需勾选 'gist' 权限</span>
                          <div style="display: flex; gap: 12px; align-items: center;">
                              <a href="https://github.com/settings/tokens" target="_blank" class="gist-link" style="margin-left: 0;">
                                  <span data-i18n="gist_link_text">去创建 Token</span>
                                  <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor" style="vertical-align: text-bottom;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6v2H5v11h11v-6h2zm-4-7h2.59l-5.3 5.29 1.41 1.41 5.3-5.3V10h2V4h-6v2z"/></svg>
                              </a>
                          </div>
                      </div>
                      <div style="display: flex; align-items: center; justify-content: space-between;">
                          <div style="font-size: 12px; color: #64748b; opacity: 0.9;" data-i18n="gist_privacy_notice">注：将自动创建私有 (Secret) Gist，他人无法访问</div>
                          <a href="https://gist.github.com/" target="_blank" class="gist-link" style="margin-left: 0;">
                              <span data-i18n="view_gists_link">查看我的 Gist</span>
                              <svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor" style="vertical-align: text-bottom;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6v2H5v11h11v-6h2zm-4-7h2.59l-5.3 5.29 1.41 1.41 5.3-5.3V10h2V4h-6v2z"/></svg>
                          </a>
                      </div>
                  </div>
                  <div class="form-grid" style="width: 100%;">
                      <div class="form-item" style="grid-column: span 12;">
                          <label data-i18n="access_token">Access Token</label>
                          <div style="position: relative; display: flex; align-items: center; width: 100%;">
                              <input type="password" id="gist-token" placeholder="ghp_xxxxxxxxxxxx" style="padding-right: 35px; width: 100%;">
                              <label class="container hide-password" id="gist-token-eye" style="position: absolute; right: 8px; margin: 0; cursor: pointer;">
                                  <input type="checkbox">
                                  <svg class="eye" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512"><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"></path></svg>
                                  <svg class="eye-slash" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 640 512"><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c8.4-19.3 10.6-41.4 4.8-63.3c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zM373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5L373 389.9z"></path></svg>
                              </label>
                          </div>
                      </div>
                      <div class="form-item" style="grid-column: span 12;">
                          <label data-i18n="gist_filename">文件名</label>
                          <input type="text" id="gist-filename" placeholder="proxy_assistant_config.json">
                      </div>
                  </div>
              </div>

              <!-- Native Config Panel -->
              <div class="sync-panel" id="native-config">
                  <div class="native-sync-info">
                      <svg viewBox="0 0 24 24" width="48" height="48" fill="#4164f5" opacity="0.8"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                      <span data-i18n="auto_sync_desc">在相同账户 (Google/FireFox) 的浏览器间同步代理数据</span>
                  </div>
              </div>

          </div>
          <div class="sync_config_footer">
              <button class="btn-test" id="test-sync-connection" style="display: none;">
                  <span data-i18n="test_connection">测试连接</span>
              </button>
              <button class="btn-save" id="save-sync-config">
                  <span data-i18n="save_config">保存</span>
              </button>
          </div>
      </div>
  </div>

  <!-- PAC Details -->
  <div class="pac_details_tip">
      <div class="pac_details_box">
          <div class="pac_details_header">
              <span data-i18n="pac_details_title">PAC 脚本详情</span>
              <div class="pac_details_close_btn"></div>
          </div>
          <div class="pac_details_content">
              <!-- PAC Info -->
              <div class="pac-info-section">
                  <div class="pac-info-row">
                      <span class="pac-info-label" data-i18n="pac_mode">模式</span>
                      <span class="pac-info-value" id="pac-mode-value">自动</span>
                  </div>
                  <div class="pac-info-row">
                      <span class="pac-info-label" data-i18n="pac_generated">生成时间</span>
                      <span class="pac-info-value" id="pac-generated-time">-</span>
                  </div>
                  <div class="pac-info-row">
                      <span class="pac-info-label" data-i18n="pac_rules_count">规则数量</span>
                      <span class="pac-info-value" id="pac-rules-count">0</span>
                  </div>
              </div>
              <!-- Rules List -->
              <div class="pac-rules-section">
                  <div class="pac-rules-title" data-i18n="pac_rules_title">代理规则</div>
                  <div class="pac-rules-list" id="pac-rules-list">
                      <!-- Dynamically inserted rules -->
                  </div>
              </div>
              <!-- Full Script -->
              <div class="pac-script-section">
                  <div class="pac-script-header">
                      <span data-i18n="pac_full_script">完整脚本</span>
                      <button class="pac-script-copy-btn" id="pac-copy-btn" data-i18n="pac_copy_script">复制</button>
                  </div>
                  <pre class="pac-script-content" id="pac-script-content"></pre>
              </div>
          </div>
          <div class="pac_details_btn">
              <div class="pac_details_close_btn2" data-i18n="close">关闭</div>
          </div>
      </div>
  </div>
</body>

<script src="./js/jquery.js"></script>
<script src="./js/i18n.js"></script>
<script type="text/javascript" src="./js/main.js"></script>

</html>
