# Release 自动化操作指令 (AI Prompt)

此文档定义了 AI 在协助用户进行项目版本发布时的标准操作流程。当用户要求执行发布或运行此文件时，请严格按照以下步骤执行。

## 📋 阶段一：初始化与信息收集

1.  **询问版本号**
    *   向用户发送请求："请提供本次发布的版本号（格式示例：1.0.0，无需 v 前缀）。"
    *   *等待用户响应...*

2.  **获取版本号**
    *   获取用户输入的版本号，记为 `VERSION`。
    *   验证格式是否为三段式数字（如 `1.0.0`）。

## 🔍 阶段二：获取与分析变更

1.  **确定对比基准**
    *   执行命令：`git describe --tags --abbrev=0` 获取上一个标签，记为 `LAST_TAG`。
    *   **分支逻辑**：
        *   如果命令成功返回 tag：对比范围为 `LAST_TAG..HEAD`。
        *   如果命令失败（无 tag）：对比范围为所有提交（即获取整个 log）。

2.  **提取 Git 日志**
    *   执行命令：`git log --pretty=format:"%s" <对比范围>`
    *   示例：`git log --pretty=format:"%s" v1.0.0..HEAD` 或 `git log --pretty=format:"%s"`

3.  **智能归类分析**
    *   遍历所有 commit message，根据以下规则将其分类到三个栏目：
    *   **规则优先级**：
        1.  **✨ 特性 (Features)**
            *   前缀匹配： `Feat:`
            *   语义匹配：涉及新增功能、添加文件、主要逻辑变更。
        2.  **🐛 问题修复 (Bug Fixes)**
            *   前缀匹配：`Fix:`
            *   语义匹配：涉及修复、解决错误、崩溃处理。
        3.  **📋 其他变更 (Other Changes)**
            *   前缀匹配：`Chore:` (或者其他除了 `Feat` 和 `Fix` 外的任何 commit)
            *   语义匹配：文档更新、格式调整、依赖升级、重构、测试用例。
            *   *默认归类*：任何无法识别或不符合上述特征的提交。

## 📝 阶段三：生成 Release 文件

1.  **构建内容**
    *   将分类好的信息整理为 Markdown 格式：

    ```markdown
    # {VERSION} Release Notes

    ## ✨ 特性
    - {Feature_List}

    ## 🐛 问题修复
    - {Fix_List}

    ## 📋 其他
    - {Other_List}
    ```

2.  **写入文件**
    *   确保 `release/` 目录存在。
    *   目标文件路径：`release/{VERSION}.md`
    *   使用 `write_to_file` 工具写入内容。

## 🏷️ 阶段四：Git 标记

1.  **创建标签**
    *   执行命令前需要请示用户是否需要执行，如果收到明确的执行指令，则执行命令：`git tag {VERSION}`
    *   *注意：直接使用版本号，不要添加额外的 v 前缀，除非用户明确要求。*

2.  **最终确认**
    *   告知用户："✅ 发布完成！Release Notes 已写入 `release/{VERSION}.md`，并已创建本地标签 `{VERSION}`。"
